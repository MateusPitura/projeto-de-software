import{r as j,j as e,t as v,c as B}from"./index-CgXIZnNG.js";import{u as A,e as N,h as L,i as k,q as f,b as M,F as m,o as b,l as R,g as u,w as q,k as O,t as V,v as z,r as C,p as T,n as H,s as K,m as Q,d as S,a as $,P as G}from"./removeMask-Doe5s-D4.js";import{u as _,A as U,S as l}from"./Section-BpcLTD7E.js";import{s as J}from"./safeFormat-B4uxrpc8.js";import{i as h,M as o,g as W}from"./Modal-DJQDksdP.js";const X=j.createContext(null);function Y({children:t}){const[a,n]=j.useState("");function r(c){n(c)}const i=j.useMemo(()=>({example:a,handleExample:r}),[a]);return e.jsx(X.Provider,{value:i,children:t})}function x({onSuccessSubmit:t,snackbarTitle:a,shouldInvalidateQuery:n=!0}){const{safeFetch:r}=A(),{userLogged:i}=N(),{showSuccessSnackbar:c}=L(),s=v();async function d(g){await r({path:`${M}/users/${i==null?void 0:i.id}`,method:"PATCH",body:g})}const{mutate:F,isPending:P}=k({mutationFn:d,onSuccess:()=>{n&&s.invalidateQueries({queryKey:[f.PROFILE_INFO]}),c({title:a}),t()}});return{mutate:F,isPending:P}}const Z=b({email:R()});function I({defaultValues:t}){const{closeDialog:a}=h(),{mutate:n,isPending:r}=x({onSuccessSubmit:a,snackbarTitle:"Email atualizado com sucesso"});return e.jsx(m,{onSubmit:n,defaultValues:t,schema:Z,children:e.jsx(ee,{isPending:r})})}function ee({isPending:t}){return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(u,{name:"email",label:"Email",required:!0})}),e.jsx(o.Footer,{labelPrimaryBtn:"Alterar",primaryBtnState:t?"loading":void 0,dirty:!0})]})}const D=B(e.jsx("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined"),E=B(e.jsx("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6m-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14M2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45zm7.5 7.5 2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13m-3.4-3.4 1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53"}),"VisibilityOffOutlined"),te={newPassword:"",confirmPassword:""};function se(){const{closeDialog:t}=h(),{mutate:a,isPending:n}=x({onSuccessSubmit:t,snackbarTitle:"Senha atualizada com sucesso",shouldInvalidateQuery:!1});function r(i){a({password:i.newPassword})}return e.jsx(m,{onSubmit:r,schema:q,defaultValues:te,children:e.jsx(ae,{isPending:n})})}function ae({isPending:t}){const[a,n]=j.useState({newPassword:!1,confirmPassword:!1});function r(i){n(c=>({...c,[i]:!c[i]}))}return e.jsxs(e.Fragment,{children:[e.jsxs(o.Body,{children:[e.jsx(u,{label:"Nova senha",name:"newPassword",iconRight:a.newPassword?e.jsx(D,{}):e.jsx(E,{}),onClickIconRight:()=>r("newPassword"),type:a.newPassword?"text":"password",required:!0}),e.jsx(u,{label:"Confirmar senha",name:"confirmPassword",iconRight:a.confirmPassword?e.jsx(D,{}):e.jsx(E,{}),onClickIconRight:()=>r("confirmPassword"),type:a.confirmPassword?"text":"password",required:!0})]}),e.jsx(o.Footer,{labelPrimaryBtn:"Alterar",primaryBtnState:t?"loading":void 0,dirty:!0})]})}const ne=b({fullName:O()});function re({defaultValues:t}){const{closeDialog:a}=h(),{mutate:n,isPending:r}=x({onSuccessSubmit:a,snackbarTitle:"Nome completo atualizado com sucesso"});return e.jsx(m,{onSubmit:n,defaultValues:t,schema:ne,children:e.jsx(oe,{isPending:r})})}function oe({isPending:t}){return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(u,{name:"fullName",label:"Nome completo",required:!0})}),e.jsx(o.Footer,{labelPrimaryBtn:"Alterar",primaryBtnState:t?"loading":void 0,dirty:!0})]})}const ie=V().extend({cep:z().transform(t=>C(t,"CEP"))});function le({defaultValues:t}){const{closeDialog:a}=h(),{mutate:n,isPending:r}=x({onSuccessSubmit:a,snackbarTitle:"Endereço atualizado com sucesso"});function i(c){n({address:c})}return e.jsx(m,{onSubmit:i,schema:ie,defaultValues:t,onlyDirty:!0,children:e.jsx(ce,{isPending:r})})}function ce({isPending:t}){const a=_({queryKey:[f.CEP_API]});return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(U,{})}),e.jsx(o.Footer,{labelPrimaryBtn:"Alterar",primaryBtnState:t||a?"loading":void 0,dirty:!0})]})}const de=b({birthDate:T()});function ue({defaultValues:t}){const{closeDialog:a}=h(),{mutate:n,isPending:r}=x({onSuccessSubmit:a,snackbarTitle:"Data de nascimento atualizada com sucesso"});return e.jsx(m,{onSubmit:n,defaultValues:t,schema:de,children:e.jsx(me,{isPending:r})})}function me({isPending:t}){return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(u,{name:"birthDate",label:"Data de nascimento",type:"date",required:!0})}),e.jsx(o.Footer,{primaryBtnState:t?"loading":void 0,dirty:!0,labelPrimaryBtn:"Alterar"})]})}const he=b({cpf:H().transform(t=>C(t,"CPF"))});function xe({defaultValues:t}){const{closeDialog:a}=h(),{isPending:n,mutate:r}=x({onSuccessSubmit:a,snackbarTitle:"CPF atualizado com sucesso"});return e.jsx(m,{onSubmit:r,defaultValues:t,schema:he,children:e.jsx(je,{isPending:n})})}function je({isPending:t}){return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(u,{name:"cpf",label:"CPF",mask:"CPF",maxLength:14,required:!0})}),e.jsx(o.Footer,{primaryBtnState:t?"loading":void 0,dirty:!0,labelPrimaryBtn:"Alterar"})]})}const be=b({code:K("default","optional")});function Pe({defaultValues:t}){const{closeDialog:a}=h(),{mutate:n,isPending:r}=x({onSuccessSubmit:a,snackbarTitle:"Matrícula atualizada com sucesso"});return e.jsx(m,{onSubmit:n,defaultValues:t,schema:be,children:e.jsx(ge,{isPending:r})})}function ge({isPending:t}){return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(u,{name:"code",label:"Matrícula"})}),e.jsx(o.Footer,{labelPrimaryBtn:"Alterar",primaryBtnState:t?"loading":void 0,dirty:!0})]})}const ye=b({cellphone:Q().transform(t=>C(t,"CELLPHONE"))});function Fe({defaultValues:t}){const{closeDialog:a}=h(),{mutate:n,isPending:r}=x({onSuccessSubmit:a,snackbarTitle:"Celular atualizado com sucesso"});return e.jsx(m,{onSubmit:n,defaultValues:t,schema:ye,children:e.jsx(Se,{isPending:r})})}function Se({isPending:t}){return e.jsxs(e.Fragment,{children:[e.jsx(o.Body,{children:e.jsx(u,{name:"cellphone",label:"Matrícula",mask:"CELLPHONE",maxLength:15})}),e.jsx(o.Footer,{labelPrimaryBtn:"Alterar",primaryBtnState:t?"loading":void 0,dirty:!0})]})}function fe(t){var a,n,r,i,c,s,d;return{fullName:t.fullName,email:t.email,cellphone:S(t.cellphone,"CELLPHONE")??"",cpf:S(t.cpf,"CPF")??"",code:t.code??"",birthDate:t.birthDate,address:{cep:S((a=t.address)==null?void 0:a.cep,"CEP")??"",number:((n=t.address)==null?void 0:n.number)??"",street:((r=t.address)==null?void 0:r.street)??"",complement:((i=t.address)==null?void 0:i.complement)??"",neighborhood:((c=t.address)==null?void 0:c.neighborhood)??"",city:((s=t.address)==null?void 0:s.city)??"",state:((d=t.address)==null?void 0:d.state)??""}}}function Ce({title:t,content:a,...n}){return e.jsxs(o,{...n,children:[e.jsx(o.Header,{title:t}),a]})}function pe(){var g,p;const[t,a]=j.useState({title:"",content:void 0}),n=W(),{userLogged:r}=N(),{safeFetch:i}=A();async function c(){return await i({path:`${M}/users/${r==null?void 0:r.id}`})}const{data:s,isFetching:d}=$({queryKey:[f.PROFILE_INFO],queryFn:c,select:fe}),F=j.useMemo(()=>{var y,w;return[(y=s==null?void 0:s.address)==null?void 0:y.street,(w=s==null?void 0:s.address)==null?void 0:w.number].filter(Boolean).join(", ")},[(g=s==null?void 0:s.address)==null?void 0:g.street,(p=s==null?void 0:s.address)==null?void 0:p.number]);function P(y){return s!=null&&s.birthDate?J({date:new Date(s==null?void 0:s.birthDate),format:y}):""}return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{...t,...n}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(G,{title:"Perfil"}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(l,{children:[e.jsx(l.Title,{title:"Informações Pessoais"}),e.jsxs(l.Group,{children:[e.jsx(l.Header,{title:"Conta"}),e.jsx(l.Row,{label:"Email",value:s==null?void 0:s.email,isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar email",content:e.jsx(I,{defaultValues:{email:s==null?void 0:s.email}})})}}),e.jsx(l.Row,{label:"Senha",value:"••••••••••••",isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar senha",content:e.jsx(se,{})})}})]}),e.jsxs(l.Group,{children:[e.jsx(l.Header,{title:"Dados"}),e.jsx(l.Row,{label:"Nome completo",value:s==null?void 0:s.fullName,isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar nome completo",content:e.jsx(re,{defaultValues:{fullName:s==null?void 0:s.fullName}})})}}),e.jsx(l.Row,{label:"Endereço",value:F,isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar endereço",content:e.jsx(le,{defaultValues:{...s==null?void 0:s.address}})})}}),e.jsx(l.Row,{label:"Data de nascimento",value:P("dd/MM/yyyy"),isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar data de nascimento",content:e.jsx(ue,{defaultValues:{birthDate:P("yyyy-MM-dd")}})})}}),e.jsx(l.Row,{label:"CPF",value:s==null?void 0:s.cpf,isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar CPF",content:e.jsx(xe,{defaultValues:{cpf:s==null?void 0:s.cpf}})})}}),e.jsx(l.Row,{label:"Matrícula",value:s==null?void 0:s.code,isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar matrícula",content:e.jsx(Pe,{defaultValues:{code:s==null?void 0:s.code}})})}}),e.jsx(l.Row,{label:"Celular",value:s==null?void 0:s.cellphone,isLoading:d,onEdit:()=>{n.openDialog(),a({title:"Alterar celular",content:e.jsx(Fe,{defaultValues:{cellphone:s==null?void 0:s.cellphone}})})}})]})]})})]})]})}function Ne(){return e.jsx(Y,{children:e.jsx(pe,{})})}export{Ne as default};
