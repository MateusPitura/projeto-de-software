import{r as l,j as o,s as g,t as P,v as b,p as U}from"./index-CgXIZnNG.js";import{d as m,u as S,h as C,a as v,i as F,q as c,b as f}from"./removeMask-Doe5s-D4.js";import{u as j}from"./Section-BpcLTD7E.js";import{U as q}from"./UserForm-Dl_81Xn8.js";import{s as M}from"./safeFormat-B4uxrpc8.js";import"./users-keCBaMHz.js";const N=l.createContext(null);function K({children:e}){const[n,a]=l.useState(!1);function i(t){a(t)}const s=l.useMemo(()=>({example:n,handleExample:i}),[n]);return o.jsx(N.Provider,{value:s,children:e})}function $(e){var n,a,i,s,t,u,r;return{fullName:e.fullName,email:e.email,cellphone:m(e.cellphone,"CELLPHONE")??"",cpf:m(e.cpf,"CPF")??"",code:e.code??"",birthDate:e.birthDate?M({date:new Date(e.birthDate),format:"yyyy-MM-dd"}):"",category:e.category??"",address:{cep:m((n=e.address)==null?void 0:n.cep,"CEP")??"",number:((a=e.address)==null?void 0:a.number)??"",street:((i=e.address)==null?void 0:i.street)??"",complement:((s=e.address)==null?void 0:s.complement)??"",neighborhood:((t=e.address)==null?void 0:t.neighborhood)??"",city:((u=e.address)==null?void 0:u.city)??"",state:((r=e.address)==null?void 0:r.state)??""}}}function w(){const{safeFetch:e}=S(),{showSuccessSnackbar:n}=C(),a=j({queryKey:[c.CEP_API]}),i=g(),s=P(),{userId:t}=b();async function u(){return await e({path:`${f}/users/${t}`})}const{data:r,isFetching:y}=v({queryKey:[c.USER,t],queryFn:u,select:$});async function p(E){await e({path:`${f}/users/${t}`,method:"PATCH",body:E})}const{mutate:h,isPending:x,isSuccess:d}=F({mutationFn:p,onSuccess:async()=>{n({title:`Usuário ${r==null?void 0:r.fullName} atualizado com sucesso`}),s.invalidateQueries({queryKey:[c.USERS]}),i("/users")}});return l.useEffect(()=>()=>{d&&s.invalidateQueries({queryKey:[c.USER]})},[d,s]),y?o.jsx("div",{className:"flex justify-center items-center h-full",children:o.jsx(U,{})}):r&&o.jsx(q,{defaultValues:r,onSubmit:h,isPending:x||!!a,headerPrimaryBtnLabel:"Alterar",headerTitle:"Alterar usuário",onlyDirty:!0})}function L(){return o.jsx(K,{children:o.jsx(w,{})})}export{L as default};
